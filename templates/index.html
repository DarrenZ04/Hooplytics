<!DOCTYPE html>
<html>
<head>
  <title>Fantasy Basketball Draft Optimizer</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Baloo+2:wght@600;700&family=Quicksand:wght@500;700&display=swap');
    body {
      font-family: 'Quicksand', 'Baloo 2', Arial, sans-serif;
      background: linear-gradient(120deg, #f8fafc 0%, #e3e7ed 100%);
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }
    .container {
      max-width: 1200px;
      margin: 32px auto;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 4px 24px rgba(0,0,0,0.08);
      padding: 32px 24px;
      overflow-x: auto;
    }
    h1 {
      text-align: center;
      color: #2d3748;
      margin-bottom: 24px;
      font-size: 2.5em;
      letter-spacing: 1px;
      font-family: 'Baloo 2', 'Quicksand', Arial, sans-serif;
      font-weight: 700;
      text-shadow: 0 2px 8px #e0e7ef;
    }
    h2, h3 {
      color: #3b4252;
      margin-top: 24px;
      margin-bottom: 12px;
      font-family: 'Baloo 2', 'Quicksand', Arial, sans-serif;
      font-weight: 600;
      letter-spacing: 0.5px;
    }
    label {
      font-size: 1.08em;
      color: #444;
      margin-bottom: 8px;
      display: block;
      font-family: 'Quicksand', 'Baloo 2', Arial, sans-serif;
      font-weight: 500;
      letter-spacing: 0.5px;
    }
    input[type="number"] {
      padding: 6px 10px;
      border-radius: 6px;
      border: 1px solid #cbd5e1;
      margin-left: 8px;
      margin-bottom: 10px;
      width: 80px;
      font-size: 1em;
      background: #f8fafc;
      transition: border 0.2s;
    }
    input[type="number"]:focus {
      border: 1.5px solid #4f46e5;
      outline: none;
    }
    #punt_categories label {
      display: inline-block;
      margin-right: 18px;
      margin-bottom: 8px;
      font-size: 0.98em;
      background: #f3f4f6;
      border-radius: 6px;
      padding: 4px 10px;
      transition: background 0.2s;
    }
    #punt_categories label:hover {
      background: #e0e7ef;
    }
    button {
      background: linear-gradient(90deg, #6366f1 0%, #60a5fa 100%);
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 10px 22px;
      font-size: 1.08em;
      font-weight: 500;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(99,102,241,0.08);
      margin-top: 16px;
      margin-bottom: 24px;
      transition: background 0.2s, box-shadow 0.2s;
    }
    button:hover {
      background: linear-gradient(90deg, #4338ca 0%, #2563eb 100%);
      box-shadow: 0 4px 16px rgba(99,102,241,0.12);
    }
    table {
      border-collapse: separate;
      border-spacing: 0;
      width: 100%;
      min-width: 1100px;
      margin-top: 10px;
      background: #f8fafc;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 12px rgba(0,0,0,0.04);
    }
    th, td {
      border-bottom: 1px solid #e5e7eb;
      padding: 14px 10px;
      text-align: left;
      font-size: 19px;
      vertical-align: middle;
    }
    th {
      background-color: #e0e7ef;
      color: #374151;
      font-weight: 600;
      letter-spacing: 0.5px;
    }
    tr:last-child td {
      border-bottom: none;
    }
    tbody tr:hover {
      background: #e0e7ef;
      transition: background 0.2s;
    }
    @media (max-width: 700px) {
      .container {
        padding: 12px 4px;
      }
      table, th, td {
        font-size: 13px;
      }
      h1 {
        font-size: 1.3em;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Fantasy Basketball Draft Optimizer (2024â€“25)</h1>

    <h2>Simulate Draft</h2>
    <label># of Teams: <input type="number" id="num_teams" value="10"></label>
    <label># of Rounds: <input type="number" id="num_rounds" value="13"></label>
    <label>Your Draft Position (1-based): <input type="number" id="your_pick" value="1"></label>

    <h3>Punt Categories</h3>
    <div id="punt_categories">
      <label><input type="checkbox" value="PTS"> Points</label>
      <label><input type="checkbox" value="REB"> Rebounds</label>
      <label><input type="checkbox" value="AST"> Assists</label>
      <label><input type="checkbox" value="STL"> Steals</label>
      <label><input type="checkbox" value="BLK"> Blocks</label>
      <label><input type="checkbox" value="FG_PCT"> FG%</label>
      <label><input type="checkbox" value="FT_PCT"> FT%</label>
      <label><input type="checkbox" value="FG3M"> 3PM</label>
      <label><input type="checkbox" value="TOV"> Turnovers</label>
    </div>

    <button onclick="simulateDraft()">Simulate Draft</button>

    <h3>Your Team</h3>
    <table id="your_team_table">
      <thead>
        <tr>
          <th>#</th>
          <th>Headshot</th>
          <th>Player</th>
          <th>Score</th>
          <th>GP</th>
          <th>PTS</th>
          <th>REB</th>
          <th>AST</th>
          <th>STL</th>
          <th>BLK</th>
          <th>FG</th>
          <th>FT</th>
          <th>3PM</th>
          <th>TOV</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <h3>Top Draft Pool</h3>
    <table id="draft_pool_table">
      <thead>
        <tr>
          <th>#</th>
          <th>Headshot</th>
          <th>Player</th>
          <th>Score</th>
          <th>GP</th>
          <th>PTS</th>
          <th>REB</th>
          <th>AST</th>
          <th>STL</th>
          <th>BLK</th>
          <th>FG</th>
          <th>FT</th>
          <th>3PM</th>
          <th>TOV</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    function simulateDraft() {
      const numTeams = document.getElementById("num_teams").value;
      const numRounds = document.getElementById("num_rounds").value;
      const yourPick = document.getElementById("your_pick").value;

      const puntChecks = document.querySelectorAll("#punt_categories input[type=checkbox]:checked");
      const puntCategories = Array.from(puntChecks).map(cb => cb.value);

      // Show loading spinner and clear tables before fetching
      const yourTeamBody = document.querySelector("#your_team_table tbody");
      const draftPoolBody = document.querySelector("#draft_pool_table tbody");
      yourTeamBody.innerHTML = '<tr><td colspan="14" style="text-align:center;font-size:1.2em;padding:32px;">Loading...</td></tr>';
      draftPoolBody.innerHTML = '<tr><td colspan="14" style="text-align:center;font-size:1.2em;padding:32px;">Loading...</td></tr>';

      fetch('/simulate_draft', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          categories: ['PTS', 'REB', 'AST', 'STL', 'BLK', 'FG_PCT', 'FT_PCT', 'FG3M', 'TOV'],
          invert: ['TOV'],
          punt: puntCategories,
          min_gp: 20,
          user_pick: yourPick,
          num_teams: numTeams,
          num_rounds: numRounds
        })
      })
      .then(res => res.json())
      .then(data => {
        yourTeamBody.innerHTML = '';
        draftPoolBody.innerHTML = '';

        data.your_team.forEach((player, index) => {
          const stats = player.stats;
          const fgPct = stats.FGA ? (stats.FGM / stats.FGA * 100).toFixed(1) : '0.0';
          const ftPct = stats.FTA ? (stats.FTM / stats.FTA * 100).toFixed(1) : '0.0';
          const headshotUrl = player.player_id ? `https://cdn.nba.com/headshots/nba/latest/1040x760/${player.player_id}.png` : 'https://cdn.nba.com/logos/nba/2024/primary/0.svg';

          const row = document.createElement("tr");
          row.innerHTML = `
            <td style="font-size:1.15em;font-weight:600;">${index + 1}</td>
            <td style="text-align:center;"><img src="${headshotUrl}" alt="Headshot" style="width:70px;height:70px;border-radius:50%;object-fit:cover;border:2.5px solid #6366f1;background:#e0e7ef;box-shadow:0 2px 8px #e0e7ef;"></td>
            <td style="font-size:1.12em;font-weight:600;">${player.name}</td>
            <td style="font-size:1.08em;">${player.adjusted_z}</td>
            <td>${player.gp}</td>
            <td>${stats.PTS}</td>
            <td>${stats.REB}</td>
            <td>${stats.AST}</td>
            <td>${stats.STL}</td>
            <td>${stats.BLK}</td>
            <td>${stats.FGM}/${stats.FGA} (${fgPct}%)</td>
            <td>${stats.FTM}/${stats.FTA} (${ftPct}%)</td>
            <td>${stats.FG3M}</td>
            <td>${stats.TOV}</td>
          `;
          yourTeamBody.appendChild(row);
        });

        data.top_draft_pool.forEach((player, index) => {
          const stats = player.stats;
          const fgPct = stats.FGA ? (stats.FGM / stats.FGA * 100).toFixed(1) : '0.0';
          const ftPct = stats.FTA ? (stats.FTM / stats.FTA * 100).toFixed(1) : '0.0';
          const headshotUrl = player.player_id ? `https://cdn.nba.com/headshots/nba/latest/1040x760/${player.player_id}.png` : 'https://cdn.nba.com/logos/nba/2024/primary/0.svg';

          const row = document.createElement("tr");
          row.innerHTML = `
            <td style="font-size:1.15em;font-weight:600;">${index + 1}</td>
            <td style="text-align:center;"><img src="${headshotUrl}" alt="Headshot" style="width:70px;height:70px;border-radius:50%;object-fit:cover;border:2.5px solid #6366f1;background:#e0e7ef;box-shadow:0 2px 8px #e0e7ef;"></td>
            <td style="font-size:1.12em;font-weight:600;">${player.name}</td>
            <td style="font-size:1.08em;">${player.adjusted_z}</td>
            <td>${player.gp}</td>
            <td>${stats.PTS}</td>
            <td>${stats.REB}</td>
            <td>${stats.AST}</td>
            <td>${stats.STL}</td>
            <td>${stats.BLK}</td>
            <td>${stats.FGM}/${stats.FGA} (${fgPct}%)</td>
            <td>${stats.FTM}/${stats.FTA} (${ftPct}%)</td>
            <td>${stats.FG3M}</td>
            <td>${stats.TOV}</td>
          `;
          draftPoolBody.appendChild(row);
        });
      });
    }
  </script>
</body>
</html>